{% extends 'base.html' %}

{% block title %}
  MoviePop | {{ user.nickname }}
{% endblock title %}


{% block content %}

<style>
.userdetail{
  margin-left: auto;
  margin-right: auto;
  margin: 0px auto;
}
.idnickname{
  margin: 0px;
  display: inline-block;
}
.atag{
  color: white;
}
a:hover{
  text-decoration: None;
  color: rgba(246, 75, 60, 0.7);
}
</style>

  <div>
    {% comment %} <h1 
      class="text-center base-title-font base-darkcrimson"
    >
      My Page
    </h1> {% endcomment %}
    <div 
      class="base-font accounts-form-width userdetail base-ivory"
      
    >
      <hr class="accounts-hr-color">
      <h4 class="ml-3">ğŸŒ½{{ user.nickname }}ë‹˜ì˜ Corn GraphğŸŒ½</h4>
      <br>
      <p id="genreData" style="display: None;">{{ genre_code }}</p>
      <canvas class="base-ivory" id="barChart"></canvas>
      <hr class="accounts-hr-color">
      <div class="">
        <h4 class="idnickname mr-4 ml-3" style="width: 100px;"> ì•„ì´ë”” |</h4>
        <h4 class="idnickname" style="width: 200px; color: white;">{{ user.username }}</h4>
        <hr class="accounts-hr-color">
        <h4 class="idnickname mr-4 ml-3" style="width: 100px;">ë‹‰ë„¤ì„ |</h4>
        <h4 class="idnickname" style="width: 200px; color: white;">{{ user.nickname }}</h4>
        <hr class="accounts-hr-color">
        <h4 class="ml-3">{{ user.nickname }}ë‹˜ì˜ ë¦¬ë·° ({{ articles|length }})</h4>
        <div class="ml-5">
          {% for article in articles %}
            <a 
              class="atag" 
              href="{% url 'community:detail' article.pk %}"
            >
              <span style="font-weight: bold;">{{ article.movie }}</span> | {{ article.title|truncatechars:20 }} | {{ article.updated_at|date:"Y/m/d H:i" }}
            </a>
            <br>
          {% endfor %}
        </div>
        <hr>
        <h4 class="ml-3">{{ user.nickname }}ë‹˜ì´ ëŒ“ê¸€ë‹¨ ë¦¬ë·° ({{ comments|length }})</h4>
        <div class="ml-5"> 
          {% for comment in comments %}
            <a 
              class="atag"
              href="{% url 'community:detail' comment.article.pk %}"
            >
              <span style="font-weight: bold;">{{ comment.content|truncatechars:20 }}</span> | {{ comment.article.title|truncatechars:20 }} | {{ comment.updated_at|date:"Y/m/d H:i" }}
            </a>
            <br>
          {% endfor %}
        </div>
        <hr>
        <h4 class="ml-3">{{ user.nickname }}ë‹˜ì´ ì¶”ì²œí•˜ëŠ” ë¦¬ë·° ({{ like_articles|length }})</h4>
        <div class="ml-5">
          {% for like in like_articles %}
            <a 
              class="atag" 
              href="{% url 'community:detail' like.pk %}"
            >
              <span style="font-weight: bold;">{{ like.movie }}</span> | {{ like.title|truncatechars:20 }}
            </a>
            <br>
          {% endfor %}
        </div>
        <hr>
        <br>
      </div>
    </div>
  

  </div>


  <script>
    //bar
      const genreData = document.querySelector('#genreData')
      const chartData = genreData.innerText
      const chartArray = chartData.split('')
      console.log(chartArray)
      const ctxB = document.getElementById("barChart").getContext('2d');
      const myBarChart = new Chart(ctxB, {
        type: 'bar',
        data: {
          labels: [
            "ì•¡ì…˜", "ë“œë¼ë§ˆ", "ìŠ¤ë¦´ëŸ¬", "ë¡œë§¨ìŠ¤", "ê°€ì¡±", "SF",
            "íŒíƒ€ì§€","ëª¨í—˜", "ì½”ë¯¸ë””", "ë²”ì£„", "ë¯¸ìŠ¤í„°ë¦¬", "ì• ë‹ˆë©”ì´ì…˜",
            "ë‹¤íë©˜í„°ë¦¬", "ì—­ì‚¬", "ì „ìŸ", "ê³µí¬", "ìŒì•…", "ì„œë¶€", "TVì˜í™”"  
          ],
          datasets: [{
            label: 'ì„ í˜¸ë„ ì§€ìˆ˜',
            data: chartArray,
            backgroundColor: [
              'rgba(255, 99, 132, 0.3)',
              'rgba(54, 162, 235, 0.3)',
              'rgba(255, 206, 86, 0.3)',
              'rgba(75, 192, 192, 0.3)',
              'rgba(153, 102, 255, 0.3)',
              'rgba(255, 159, 64, 0.3)',
              'rgba(255, 99, 132, 0.3)',
              'rgba(54, 162, 235, 0.3)',
              'rgba(255, 206, 86, 0.3)',
              'rgba(75, 192, 192, 0.3)',
              'rgba(153, 102, 255, 0.3)',
              'rgba(255, 159, 64, 0.3)',
              'rgba(255, 99, 132, 0.3)',
              'rgba(54, 162, 235, 0.3)',
              'rgba(255, 206, 86, 0.3)',
              'rgba(75, 192, 192, 0.3)',
              'rgba(153, 102, 255, 0.3)',
              'rgba(255, 159, 64, 0.3)',
              'rgba(255, 99, 132, 0.3)'
            ],
            borderColor: [
              'rgba(255,99,132,1)',
              'rgba(54, 162, 235, 1)',
              'rgba(255, 206, 86, 1)',
              'rgba(75, 192, 192, 1)',
              'rgba(153, 102, 255, 1)',
              'rgba(255, 159, 64, 1)',
              'rgba(255,99,132,1)',
              'rgba(54, 162, 235, 1)',
              'rgba(255, 206, 86, 1)',
              'rgba(75, 192, 192, 1)',
              'rgba(153, 102, 255, 1)',
              'rgba(255, 159, 64, 1)',
              'rgba(255,99,132,1)',
              'rgba(54, 162, 235, 1)',
              'rgba(255, 206, 86, 1)',
              'rgba(75, 192, 192, 1)',
              'rgba(153, 102, 255, 1)',
              'rgba(255, 159, 64, 1)',
              'rgba(255,99,132,1)',
              ],
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true
              }
            }]
          }
        }
      });
  </script>
{% endblock content %}
